<!DOCTYPE html>
<html>
<head>
    <title>Phases Development Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .phase { border: 2px solid #ddd; margin: 20px 0; padding: 15px; border-radius: 8px; }
        .foundation { border-color: #FF5722; background: #FFF3E0; }
        .core { border-color: #FF9800; background: #FFF8E1; }
        .features { border-color: #4CAF50; background: #E8F5E8; }
        .node { border: 1px solid #ccc; border-radius: 4px; padding: 8px; margin: 5px; display: inline-block; min-width: 120px; }
        .critical { background: #C8E6C9; }
        .timeline { display: flex; align-items: center; margin: 10px 0; }
        .week-bar { height: 20px; background: #2196F3; margin: 0 5px; border-radius: 3px; }
        .milestone { font-weight: bold; color: #1976D2; }
    </style>
</head>
<body>
    <h1>Phases Development Viewer</h1>
    
    <div id="timeline-container"></div>
    <div id="phases-container"></div>

    <script>
        let nodesData = null;

        async function loadData() {
            try {
                const response = await fetch('nodes_v2_phases.json');
                nodesData = await response.json();
                renderTimeline();
                renderPhases();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = '<h3>Development Timeline</h3>';

            if (!nodesData.phases) return;

            let totalWeeks = 0;
            Object.entries(nodesData.phases).forEach(([phaseName, phase]) => {
                const timelineEl = document.createElement('div');
                timelineEl.className = 'timeline';
                
                const weeks = phase.duration_weeks || 0;
                totalWeeks += weeks;
                
                timelineEl.innerHTML = `
                    <strong>${phaseName}:</strong>
                    <div class="week-bar" style="width: ${weeks * 20}px;"></div>
                    <span>${weeks} weeks</span>
                    <span class="milestone">${phase.milestone}</span>
                `;
                
                container.appendChild(timelineEl);
            });

            const totalEl = document.createElement('div');
            totalEl.innerHTML = `<strong>Total: ${totalWeeks} weeks</strong>`;
            container.appendChild(totalEl);
        }

        function renderPhases() {
            const container = document.getElementById('phases-container');
            container.innerHTML = '';

            if (!nodesData.phases) return;

            Object.entries(nodesData.phases).forEach(([phaseName, phase]) => {
                const phaseEl = document.createElement('div');
                phaseEl.className = `phase ${phaseName}`;
                
                phaseEl.innerHTML = `
                    <h3>${phaseName.toUpperCase()} - ${phase.milestone}</h3>
                    <p>Duration: ${phase.duration_weeks} weeks | Criteria: ${phase.criteria.join(', ')}</p>
                    ${phase.depends_on ? `<p>Depends on: ${phase.depends_on.join(', ')}</p>` : ''}
                `;

                // Add nodes for this phase
                const nodesInPhase = Object.values(nodesData.nodes).filter(node => 
                    node.phase === phaseName || (phase.criteria && phase.criteria.includes(node.criteriaId))
                );

                nodesInPhase.forEach(node => {
                    const nodeEl = document.createElement('div');
                    nodeEl.className = `node ${node.type}`;
                    nodeEl.innerHTML = `
                        <div><strong>${node.title}</strong></div>
                        ${node.weeks_estimate ? `<div>Est: ${node.weeks_estimate}w</div>` : ''}
                        ${node.parallel_with ? `<div>Parallel: ${node.parallel_with.join(', ')}</div>` : ''}
                    `;
                    phaseEl.appendChild(nodeEl);
                });

                container.appendChild(phaseEl);
            });
        }

        loadData();
    </script>
</body>
</html>