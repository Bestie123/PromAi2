<!DOCTYPE html>
<html>
<head>
    <title>Option 3: Dependency Graph</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { display: flex; gap: 20px; }
        .nodes-panel { flex: 1; }
        .metrics-panel { flex: 1; }
        .node { border: 2px solid #ccc; border-radius: 8px; padding: 10px; margin: 5px; position: relative; min-width: 140px; }
        .critical { background: #E8F5E8; }
        .question { background: #E3F2FD; }
        .critical-path { border-color: #FF5722; box-shadow: 0 0 5px #FF5722; }
        .bottleneck { border-color: #f44336; box-shadow: 0 0 8px red; }
        .weight-indicator { position: absolute; top: -8px; right: -8px; background: #2196F3; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; font-size: 12px; line-height: 20px; }
        .risk-high { border-left: 5px solid #f44336; }
        .risk-medium { border-left: 5px solid #FF9800; }
        .risk-low { border-left: 5px solid #4CAF50; }
        .track { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        .foundation { background: #FFF3E0; }
        .ui { background: #E8F5E8; }
        .data { background: #E3F2FD; }
        .plugins { background: #F3E5F5; }
        .edge { margin: 5px 0; padding: 5px; background: #f5f5f5; border-radius: 4px; }
        .strong { border-left: 4px solid #4CAF50; }
        .medium { border-left: 4px solid #FF9800; }
        .controls { margin-bottom: 20px; }
        button { margin: 5px; padding: 8px 16px; }
        .path { background: #FFECB3; padding: 10px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Option 3: Dependency Graph</h1>
    <p><strong>–ü–æ–¥—Ö–æ–¥:</strong> –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –≤–µ—Å–∞–º–∏ –∏ —Ç–∏–ø–∞–º–∏ —Å–≤—è–∑–µ–π</p>
    
    <div class="controls">
        <button onclick="showCriticalPath()">Critical Path</button>
        <button onclick="showBottlenecks()">Bottlenecks</button>
        <button onclick="showTracks()">Parallel Tracks</button>
        <button onclick="showRisks()">Risk Matrix</button>
        <button onclick="showAll()">All</button>
    </div>

    <div id="path-container"></div>
    
    <div class="container">
        <div class="nodes-panel">
            <h3>Nodes</h3>
            <div id="nodes-container"></div>
        </div>
        
        <div class="metrics-panel">
            <h3>Graph Metrics</h3>
            <div id="metrics-container"></div>
            
            <h3>Edges</h3>
            <div id="edges-container"></div>
            
            <h3>Parallel Tracks</h3>
            <div id="tracks-container"></div>
        </div>
    </div>

    <script>
        let nodesData = null;

        async function loadData() {
            try {
                const response = await fetch('option3_graph_nodes.json');
                nodesData = await response.json();
                renderNodes();
                renderMetrics();
                renderEdges();
                renderTracks();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function renderNodes(filter = null) {
            const container = document.getElementById('nodes-container');
            container.innerHTML = '';

            Object.values(nodesData.nodes).forEach(node => {
                if (filter && !filter(node)) return;

                const nodeEl = document.createElement('div');
                nodeEl.className = `node ${node.type}`;
                
                if (node.graph) {
                    if (node.graph.critical_path) nodeEl.classList.add('critical-path');
                    if (node.graph.bottleneck) nodeEl.classList.add('bottleneck');
                    if (node.graph.risk) nodeEl.classList.add(`risk-${node.graph.risk}`);
                }

                nodeEl.innerHTML = `
                    <div><strong>${node.title}</strong></div>
                    ${node.graph ? `
                        <div class="weight-indicator">${node.graph.weight}</div>
                        <div style="font-size: 12px; color: #666;">
                            Weight: ${node.graph.weight} | Risk: ${node.graph.risk}<br>
                            ${node.graph.critical_path ? 'üî• Critical Path' : ''} 
                            ${node.graph.bottleneck ? '‚ö†Ô∏è Bottleneck' : ''}
                        </div>
                    ` : ''}
                `;

                container.appendChild(nodeEl);
            });
        }

        function renderMetrics() {
            const container = document.getElementById('metrics-container');
            if (!nodesData.graph_metrics) return;

            const metrics = nodesData.graph_metrics;
            container.innerHTML = `
                <div><strong>Critical Path:</strong><br>${metrics.critical_path ? metrics.critical_path.join(' ‚Üí ') : 'N/A'}</div>
                <div style="margin-top: 10px;"><strong>Bottlenecks:</strong><br>${metrics.bottlenecks ? metrics.bottlenecks.join(', ') : 'N/A'}</div>
            `;
        }

        function renderEdges() {
            const container = document.getElementById('edges-container');
            if (!nodesData.edges) return;

            container.innerHTML = '';
            nodesData.edges.forEach(edge => {
                const edgeEl = document.createElement('div');
                edgeEl.className = `edge ${edge.strength}`;
                edgeEl.innerHTML = `
                    <strong>${edge.from}</strong> ‚Üí <strong>${edge.to}</strong><br>
                    ${edge.type} | ${edge.strength} | ${edge.delay_weeks}w delay
                `;
                container.appendChild(edgeEl);
            });
        }

        function renderTracks() {
            const container = document.getElementById('tracks-container');
            if (!nodesData.graph_metrics || !nodesData.graph_metrics.parallel_tracks) return;

            container.innerHTML = '';
            Object.entries(nodesData.graph_metrics.parallel_tracks).forEach(([trackName, nodes]) => {
                const trackEl = document.createElement('div');
                trackEl.className = `track ${trackName}`;
                trackEl.innerHTML = `
                    <strong>${trackName}:</strong><br>${nodes.join(', ')}
                `;
                container.appendChild(trackEl);
            });
        }

        function showCriticalPath() {
            const pathEl = document.getElementById('path-container');
            pathEl.innerHTML = `
                <div class="path">
                    <strong>üî• Critical Path:</strong> ${nodesData.graph_metrics.critical_path.join(' ‚Üí ')}
                </div>
            `;
            renderNodes(node => nodesData.graph_metrics.critical_path.includes(node.id));
        }

        function showBottlenecks() {
            renderNodes(node => node.graph && node.graph.bottleneck);
        }

        function showTracks() {
            // Show all tracks in different colors
            renderTracks();
        }

        function showRisks() {
            const container = document.getElementById('path-container');
            const risks = nodesData.graph_metrics.risk_matrix;
            container.innerHTML = `
                <div class="path">
                    <strong>üî¥ High Risk:</strong> ${risks.high.join(', ')}<br>
                    <strong>üü° Medium Risk:</strong> ${risks.medium.join(', ')}<br>
                    <strong>üü¢ Low Risk:</strong> ${risks.low.join(', ')}
                </div>
            `;
        }

        function showAll() {
            document.getElementById('path-container').innerHTML = '';
            renderNodes();
        }

        loadData();
    </script>
</body>
</html>