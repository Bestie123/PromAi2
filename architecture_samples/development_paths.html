<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromAi PKM - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0d1117; color: #c9d1d9; overflow: hidden;
        }
        #canvas { 
            width: 16000px; height: 10000px; position: relative; 
            background: radial-gradient(circle at 50% 50%, #161b22 0%, #0d1117 100%);
            transform-origin: 0 0;
        }
        #viewport { 
            width: 100vw; height: 100vh; overflow: hidden; position: relative;
            cursor: grab; background: #0d1117;
        }
        #viewport.dragging { cursor: grabbing; }
        
        .node {
            position: absolute; background: #21262d; border: 3px solid #30363d;
            border-radius: 12px; padding: 16px; min-width: 300px; max-width: 350px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4); transition: all 0.3s ease;
        }
        .node:hover { transform: scale(1.05); box-shadow: 0 12px 48px rgba(0,0,0,0.6); z-index: 100; }
        
        .critical-path { 
            border-color: #f85149; 
            background: linear-gradient(135deg, #2d1b1f 0%, #21262d 100%);
            box-shadow: 0 0 30px rgba(248, 81, 73, 0.3);
        }
        .parallel { 
            border-color: #3fb950; 
            background: linear-gradient(135deg, #1b2d1f 0%, #21262d 100%);
        }
        .flexible { 
            border-color: #58a6ff; 
            background: linear-gradient(135deg, #1b2332 0%, #21262d 100%);
        }
        
        .badge {
            display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 11px;
            font-weight: bold; margin-bottom: 8px; margin-right: 4px;
        }
        .badge.critical { background: #f85149; color: #fff; }
        .badge.parallel { background: #3fb950; color: #fff; }
        .badge.flexible { background: #58a6ff; color: #fff; }
        .badge.week { background: #8b949e; color: #fff; }
        
        .node h3 { font-size: 15px; margin-bottom: 8px; color: #f0f6fc; font-weight: 600; }
        .node p { font-size: 12px; line-height: 1.5; margin-bottom: 6px; color: #8b949e; }
        .node .time { font-size: 11px; color: #6e7681; font-style: italic; }
        .node .blocks { font-size: 11px; color: #f85149; margin-top: 6px; font-weight: bold; }
        .node .requires { font-size: 11px; color: #f79009; margin-top: 4px; }
        
        .connection {
            position: absolute; height: 3px; transform-origin: left center;
            z-index: -1; transition: all 0.3s ease;
        }
        .connection.critical { background: #f85149; box-shadow: 0 0 10px rgba(248, 81, 73, 0.5); }
        .connection.parallel { background: #3fb950; }
        .connection.flexible { background: #58a6ff; }
        
        .arrow {
            position: absolute; width: 0; height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 12px solid #f85149;
            right: -8px; top: -5px;
        }
        .connection.parallel .arrow { border-top-color: #3fb950; }
        .connection.flexible .arrow { border-top-color: #58a6ff; }
        
        .phase-label {
            position: absolute; font-size: 24px; font-weight: bold;
            color: #58a6ff; text-shadow: 0 0 20px rgba(88, 166, 255, 0.5);
            padding: 12px 20px; background: rgba(33, 38, 45, 0.8);
            border-radius: 8px; border: 2px solid #58a6ff;
        }
        
        .controls {
            position: fixed; top: 20px; left: 20px; z-index: 1000;
            background: rgba(33, 38, 45, 0.95); padding: 16px; border-radius: 8px;
            border: 1px solid #30363d; max-width: 350px;
        }
        .controls button {
            background: #238636; color: #fff; border: none; padding: 8px 12px;
            border-radius: 6px; margin-right: 8px; margin-bottom: 8px; cursor: pointer; font-size: 12px;
        }
        .controls button:hover { background: #2ea043; }
        .controls .legend { margin-top: 12px; font-size: 11px; }
        .controls .legend-item { margin: 6px 0; display: flex; align-items: center; }
        .controls .legend-box { 
            width: 20px; height: 20px; border-radius: 4px; margin-right: 8px;
            display: inline-block;
        }
        
        .zoom-info {
            position: fixed; bottom: 20px; right: 20px; z-index: 1000;
            background: rgba(33, 38, 45, 0.9); padding: 8px 12px; border-radius: 6px;
            border: 1px solid #30363d; font-size: 12px;
        }
        
        .stats {
            position: fixed; bottom: 20px; left: 20px; z-index: 1000;
            background: rgba(33, 38, 45, 0.9); padding: 12px 16px; border-radius: 6px;
            border: 1px solid #30363d; font-size: 12px;
        }
        .stats div { margin: 4px 0; }
        .stats .critical-stat { color: #f85149; }
        .stats .parallel-stat { color: #3fb950; }
        .stats .time-stat { color: #58a6ff; }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="resetView()">–°–±—Ä–æ—Å</button>
        <button onclick="focusPhase(1)">–§–∞–∑–∞ 1</button>
        <button onclick="focusPhase(2)">–§–∞–∑–∞ 2</button>
        <button onclick="focusPhase(3)">–§–∞–∑–∞ 3</button>
        <button onclick="focusPhase(4)">–§–∞–∑–∞ 4</button>
        
        <div class="legend">
            <div class="legend-item">
                <span class="legend-box" style="background: #f85149;"></span>
                <span>üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å (–±–ª–æ–∫–∏—Ä—É–µ—Ç)</span>
            </div>
            <div class="legend-item">
                <span class="legend-box" style="background: #3fb950;"></span>
                <span>üü¢ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)</span>
            </div>
            <div class="legend-item">
                <span class="legend-box" style="background: #58a6ff;"></span>
                <span>üîµ –ì–∏–±–∫–∏–π (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)</span>
            </div>
        </div>
    </div>
    
    <div class="zoom-info">
        –ó—É–º: <span id="zoomLevel">100%</span>
    </div>
    
    <div class="stats">
        <div class="critical-stat">üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å: 50-65 –¥–Ω–µ–π</div>
        <div class="parallel-stat">üü¢ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ: 18-29 –¥–Ω–µ–π</div>
        <div class="time-stat">‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è MVP: 68-94 –¥–Ω—è</div>
        <div style="color: #8b949e; margin-top: 8px;">–ö–æ–º–∞–Ω–¥–∞: 2-3 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</div>
    </div>
    
    <div id="viewport">
        <div id="canvas"></div>
    </div>

    <script>
        const LAYOUT = {
            START_X: 500,
            START_Y: 300,
            HORIZONTAL_SPACING: 600,
            VERTICAL_SPACING: 250,
            PHASE_SPACING: 1500
        };

        const phases = [
            {
                name: "–§–∞–∑–∞ 1: –§—É–Ω–¥–∞–º–µ–Ω—Ç",
                week: "Week 1-2",
                time: "21-29 –¥–Ω–µ–π",
                x: 500,
                y: 100,
                nodes: [
                    { id: 1, title: "1. –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", desc: "–Ø–¥—Ä–æ –æ—Ç–¥–µ–ª–µ–Ω–æ –æ—Ç UI –∏ –ø–ª–∞–≥–∏–Ω–æ–≤", time: "2-3 –¥–Ω—è", blocks: "–í–°–Å", requires: "-", type: "critical-path" },
                    { id: 29, title: "29. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞", desc: "–§–∞–π–ª—ã ‚â§500 —Å—Ç—Ä–æ–∫, —Ñ—É–Ω–∫—Ü–∏–∏ ‚â§50", time: "1 –¥–µ–Ω—å", blocks: "–∫–∞—á–µ—Å—Ç–≤–æ", requires: "1", type: "critical-path" },
                    { id: 2, title: "2. –ë–ª–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞", desc: "–í—Å—ë —è–≤–ª—è–µ—Ç—Å—è –±–ª–æ–∫–∞–º–∏", time: "2-3 –¥–Ω—è", blocks: "3, 4", requires: "1", type: "critical-path" },
                    { id: 3, title: "3. UUID –¥–ª—è –±–ª–æ–∫–æ–≤", desc: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ ID", time: "1 –¥–µ–Ω—å", blocks: "4, 7", requires: "2", type: "critical-path" },
                    { id: 4, title: "4. –í–ª–æ–∂–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏", desc: "–ò–µ—Ä–∞—Ä—Ö–∏—è –ª—é–±–æ–π –≥–ª—É–±–∏–Ω—ã", time: "2-3 –¥–Ω—è", blocks: "13", requires: "3", type: "critical-path" },
                    { id: 9, title: "9. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ", desc: "JSON –∏–ª–∏ SQLite", time: "2-3 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 11, title: "11. –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π UI", desc: "JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏", time: "2-3 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 12, title: "12. Zero runtime logic", desc: "–ß–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞", time: "1-2 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 20, title: "20. –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è", desc: "–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ", time: "1 –¥–µ–Ω—å", blocks: "-", requires: "-", type: "parallel" },
                    { id: 10, title: "10. –ü–æ–ª–Ω–∞—è –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞", desc: "–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ —Å–µ—Ç–∏", time: "1-2 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 15, title: "15. Schema-first", desc: "JSON Schema + Zod", time: "2-3 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" }
                ]
            },
            {
                name: "–§–∞–∑–∞ 2: CRDT –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏",
                week: "Week 2-3",
                time: "15-20 –¥–Ω–µ–π",
                x: 3500,
                y: 100,
                nodes: [
                    { id: 13, title: "13. CRDT (Yjs)", desc: "Single source of truth", time: "5-7 –¥–Ω–µ–π", blocks: "14, 16, 18, 25", requires: "4", type: "critical-path" },
                    { id: 16, title: "16. –í—Å–µ —á–µ—Ä–µ–∑ CRDT", desc: "–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ CRDT", time: "3-4 –¥–Ω—è", blocks: "17, 25", requires: "13", type: "critical-path" },
                    { id: 17, title: "17. –ê—Ç–æ–º–∞—Ä–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏", desc: "–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, undo/redo", time: "3-4 –¥–Ω—è", blocks: "undo/redo", requires: "16", type: "critical-path" },
                    { id: 14, title: "14. Event Sourcing", desc: "Immutable ops log", time: "2-3 –¥–Ω—è", blocks: "versioning", requires: "13", type: "critical-path" },
                    { id: 7, title: "7. Refs –ø–æ UUID", desc: "–°—Å—ã–ª–∫–∏ –Ω–∞ –±–ª–æ–∫–∏", time: "2-3 –¥–Ω—è", blocks: "8, 18", requires: "3", type: "parallel" },
                    { id: 8, title: "8. Backlinks", desc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—Ä–∞—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏", time: "2-3 –¥–Ω—è", blocks: "-", requires: "7", type: "parallel" },
                    { id: 18, title: "18. Refs –≤ CRDT", desc: "First-class —Å—Å—ã–ª–∫–∏", time: "3-4 –¥–Ω—è", blocks: "-", requires: "13, 7", type: "parallel" },
                    { id: 19, title: "19. –ü–ª–æ—Å–∫–∏–π –≥—Ä–∞—Ñ", desc: "–ë–ª–æ–∫–∏ ‚â† —Å—Ç—Ä–∞–Ω–∏—Ü—ã", time: "1-2 –¥–Ω—è", blocks: "-", requires: "-", type: "flexible" }
                ]
            },
            {
                name: "–§–∞–∑–∞ 3: UI –∏ –∫–æ–Ω—Ç–µ–Ω—Ç",
                week: "Week 3-4",
                time: "17-24 –¥–Ω—è",
                x: 6500,
                y: 100,
                nodes: [
                    { id: 6, title: "6. Rich Text", desc: "Markdown + WYSIWYG", time: "7-10 –¥–Ω–µ–π", blocks: "UX", requires: "2, 16", type: "critical-path" },
                    { id: 21, title: "21. Virtual scrolling", desc: "–†–∞–±–æ—Ç–∞ —Å 100k+ –±–ª–æ–∫–æ–≤", time: "5-7 –¥–Ω–µ–π", blocks: "performance", requires: "11", type: "critical-path" },
                    { id: 5, title: "5. Drag & Drop", desc: "–ü–æ—Ä—è–¥–æ–∫ –±–ª–æ–∫–æ–≤", time: "5-7 –¥–Ω–µ–π", blocks: "UX", requires: "4, 21", type: "critical-path" },
                    { id: 22, title: "22. Web Workers", desc: "–ü–æ–∏—Å–∫, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, CRDT", time: "4-5 –¥–Ω–µ–π", blocks: "-", requires: "-", type: "parallel" },
                    { id: 23, title: "23. Circular Detection", desc: "–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤", time: "2-3 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 24, title: "24. E2EE –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å", desc: "–§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è", time: "3-4 –¥–Ω—è", blocks: "-", requires: "-", type: "parallel" },
                    { id: 25, title: "25. –ö–æ–Ω—Ñ–ª–∏–∫—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç", desc: "CRDT merge", time: "3-4 –¥–Ω—è", blocks: "-", requires: "13, 16", type: "parallel" }
                ]
            },
            {
                name: "–§–∞–∑–∞ 4: –ü–ª–∞–≥–∏–Ω—ã",
                week: "Week 5-6",
                time: "15-21 –¥–µ–Ω—å",
                x: 9500,
                y: 100,
                nodes: [
                    { id: 26, title: "26. –ü–ª–∞–≥–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞", desc: "–ï–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º", time: "7-10 –¥–Ω–µ–π", blocks: "27, 28", requires: "1, 2", type: "critical-path" },
                    { id: 27, title: "27. –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –±–ª–æ–∫–∏", desc: "–ö–∞—Å—Ç–æ–º–Ω—ã–µ –±–ª–æ–∫–∏ —Å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å—é", time: "5-7 –¥–Ω–µ–π", blocks: "–ø–ª–∞–≥–∏–Ω—ã", requires: "26, 4", type: "critical-path" },
                    { id: 28, title: "28. –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–æ–≤", desc: "JSON —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤", time: "3-4 –¥–Ω—è", blocks: "–≤–∏–¥–∂–µ—Ç—ã", requires: "26", type: "critical-path" }
                ]
            }
        ];

        let scale = 0.15;
        let translateX = 100;
        let translateY = 100;
        let isDragging = false;
        let lastMouseX = 0;
        let lastMouseY = 0;

        function createNode(node, phaseX, phaseY, index, criticalIndex) {
            const div = document.createElement('div');
            div.className = `node ${node.type}`;
            
            let x, y;
            if (node.type === 'critical-path') {
                x = phaseX + 100;
                y = phaseY + 300 + (criticalIndex * LAYOUT.VERTICAL_SPACING);
            } else if (node.type === 'parallel') {
                x = phaseX + 800;
                y = phaseY + 300 + ((index - criticalIndex) * LAYOUT.VERTICAL_SPACING);
            } else {
                x = phaseX + 1500;
                y = phaseY + 300 + ((index - criticalIndex) * LAYOUT.VERTICAL_SPACING);
            }
            
            div.style.left = x + 'px';
            div.style.top = y + 'px';
            div.dataset.x = x;
            div.dataset.y = y;
            div.dataset.id = node.id;
            
            const badgeType = node.type === 'critical-path' ? 'critical' : 
                             node.type === 'parallel' ? 'parallel' : 'flexible';
            const badgeText = node.type === 'critical-path' ? 'üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô' : 
                             node.type === 'parallel' ? 'üü¢ –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–´–ô' : 'üîµ –ì–ò–ë–ö–ò–ô';
            
            div.innerHTML = `
                <div class="badge ${badgeType}">${badgeText}</div>
                <h3>${node.title}</h3>
                <p>${node.desc}</p>
                <div class="time">‚è±Ô∏è ${node.time}</div>
                ${node.blocks !== '-' ? `<div class="blocks">üö´ –ë–ª–æ–∫–∏—Ä—É–µ—Ç: ${node.blocks}</div>` : ''}
                ${node.requires !== '-' ? `<div class="requires">üìã –¢—Ä–µ–±—É–µ—Ç: ${node.requires}</div>` : ''}
            `;
            
            return div;
        }

        function createConnection(from, to, type) {
            const line = document.createElement('div');
            line.className = `connection ${type}`;
            
            const dx = to.x - from.x;
            const dy = to.y - from.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            line.style.left = (from.x + 175) + 'px';
            line.style.top = (from.y + 60) + 'px';
            line.style.width = length + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            
            const arrow = document.createElement('div');
            arrow.className = 'arrow';
            line.appendChild(arrow);
            
            return line;
        }

        function createPhaseLabel(phase) {
            const label = document.createElement('div');
            label.className = 'phase-label';
            label.style.left = phase.x + 'px';
            label.style.top = phase.y + 'px';
            label.innerHTML = `
                <div>${phase.name}</div>
                <div style="font-size: 14px; color: #8b949e; margin-top: 4px;">${phase.week} ‚Ä¢ ${phase.time}</div>
            `;
            return label;
        }

        function initCanvas() {
            const canvas = document.getElementById('canvas');
            canvas.innerHTML = '';
            const nodeMap = {};
            
            phases.forEach(phase => {
                canvas.appendChild(createPhaseLabel(phase));
                
                let criticalCount = phase.nodes.filter(n => n.type === 'critical-path').length;
                let criticalIndex = 0;
                
                phase.nodes.forEach((node, index) => {
                    const nodeEl = createNode(node, phase.x, phase.y, index, criticalIndex);
                    canvas.appendChild(nodeEl);
                    nodeMap[node.id] = {
                        x: parseFloat(nodeEl.dataset.x),
                        y: parseFloat(nodeEl.dataset.y),
                        type: node.type,
                        requires: node.requires
                    };
                    
                    if (node.type === 'critical-path') criticalIndex++;
                });
            });
            
            // Draw connections
            Object.keys(nodeMap).forEach(id => {
                const node = nodeMap[id];
                if (node.requires && node.requires !== '-') {
                    const deps = node.requires.split(',').map(d => d.trim());
                    deps.forEach(depId => {
                        const depNode = nodeMap[depId];
                        if (depNode) {
                            const connection = createConnection(depNode, node, node.type);
                            canvas.appendChild(connection);
                        }
                    });
                }
            });
        }

        function updateTransform() {
            const canvas = document.getElementById('canvas');
            canvas.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
            document.getElementById('zoomLevel').textContent = Math.round(scale * 100) + '%';
        }

        function resetView() {
            scale = 0.15;
            translateX = 100;
            translateY = 100;
            updateTransform();
        }

        function focusPhase(phaseNum) {
            const phase = phases[phaseNum - 1];
            scale = 0.25;
            translateX = window.innerWidth / 2 - (phase.x * scale);
            translateY = window.innerHeight / 2 - ((phase.y + 400) * scale);
            updateTransform();
        }

        const viewport = document.getElementById('viewport');

        viewport.addEventListener('wheel', (e) => {
            e.preventDefault();
            const rect = viewport.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            const newScale = Math.max(0.05, Math.min(2, scale * delta));
            const canvasX = (mouseX - translateX) / scale;
            const canvasY = (mouseY - translateY) / scale;
            scale = newScale;
            translateX = mouseX - canvasX * scale;
            translateY = mouseY - canvasY * scale;
            updateTransform();
        });

        viewport.addEventListener('mousedown', (e) => {
            if (e.button === 0) {
                isDragging = true;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
                viewport.classList.add('dragging');
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const deltaX = e.clientX - lastMouseX;
                const deltaY = e.clientY - lastMouseY;
                translateX += deltaX;
                translateY += deltaY;
                lastMouseX = e.clientX;
                lastMouseY = e.clientY;
                updateTransform();
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            viewport.classList.remove('dragging');
        });

        initCanvas();
        updateTransform();
    </script>
</body>
</html>
